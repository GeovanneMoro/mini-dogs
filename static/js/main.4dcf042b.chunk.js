(this["webpackJsonp17-redux-desafio-3"]=this["webpackJsonp17-redux-desafio-3"]||[]).push([[0],{21:function(e,t,n){e.exports={loading:"Loading_loading__1SIf8"}},22:function(e,t,n){e.exports={button:"PhotosLoadMore_button__3ioRG"}},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(0),o=n.n(r),c=n(12),i=n.n(c),s=n(2),u=n(4),l=n.n(u),d=n(5),f=n(3),j=n(11),p=n(6),b=function(e){var t=Object(p.b)({name:e.name,initialState:Object(j.a)({loading:!1,data:null,error:null},e.initialState),reducers:Object(j.a)({fetchStarted:function(e){e.loading=!0},fetchSucess:function(e,t){e.loading=!1,e.data=t.payload,e.error=null},fetchError:function(e,t){e.loading=!1,e.data=null,e.error=t.payload}},e.reducers)}),n=t.actions,a=n.fetchStarted,r=n.fetchSucess,o=n.fetchError;return Object(j.a)(Object(j.a)({},t),{},{asyncAction:function(t){return function(){var n=Object(d.a)(l.a.mark((function n(c){var i,s,u,d,f;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c(a()),i=e.fetchConfig(t),s=i.url,u=i.options,n.next=5,fetch(s,u);case 5:return d=n.sent,n.next=8,d.json();case 8:return f=n.sent,n.abrupt("return",c(r(f)));case 12:return n.prev=12,n.t0=n.catch(0),n.abrupt("return",c(o(n.t0.message)));case 15:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(e){return n.apply(this,arguments)}}()}})},h=function(e,t){try{return JSON.parse(window.localStorage.getItem(e))}catch(n){return t}},m=n(14),g=b({name:"photos",initialState:{list:[],pages:0,infinite:!0},reducers:{addPhotos:function(e,t){var n;(n=e.list).push.apply(n,Object(m.a)(t.payload)),e.pages++,0===t.payload.length&&(e.infinite=!1)},removePhotos:function(e){e.pages=0,e.infinite=!0,e.list=[],e.data=null}},fetchConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{url:"https://dogsapi.origamid.dev/json/api/photo/?_page=".concat(e,"&_total=3&_user=0"),options:{method:"GET",cache:"no-store"}}}}),O=g.asyncAction,v=g.actions,x=v.addPhotos,_=v.removePhotos,k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(){var t=Object(d.a)(l.a.mark((function t(n){var a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(O(e));case 2:a=t.sent,r=a.payload,n(x(r));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},y=g.reducer,S=b({name:"token",initialState:{data:{token:h("token",null)}},reducers:{removeToken:function(e){e.data=null},fetchSucess:{reducer:function(e,t){e.loading=!1,e.data=t.payload,e.error=null},prepare:function(e){return{payload:e,meta:{localStorage:{key:"token",value:e.token}}}}}},fetchConfig:function(e){return{url:"https://dogsapi.origamid.dev/json/jwt-auth/v1/token",options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}}}}),w=b({name:"user",reducers:{removeUser:function(e){e.data=null}},fetchConfig:function(e){return{url:"https://dogsapi.origamid.dev/json/api/user",options:{method:"GET",headers:{Authorization:"Bearer "+e}}}}}),N=Object(f.c)({token:S.reducer,user:w.reducer}),C=S.asyncAction,P=w.asyncAction,E=S.actions.removeToken,A=w.actions.removeUser,T=N,L=n(7),H=n.n(L),I=function(){var e=Object(s.c)((function(e){return e.login})),t=e.token,n=e.user,r=t.loading||n.loading,o=Object(s.b)();return Object(a.jsxs)("header",{className:H.a.header,children:[Object(a.jsx)("h1",{className:H.a.title,children:"Mini Dogs"}),Object(a.jsx)("button",{onClick:function(){return o((function(e){e(A()),e(E()),e(_()),window.localStorage.removeItem("token")}))},"aria-label":"Logout",className:"\n        ".concat(H.a.login,"\n        ").concat(r?H.a.loading:"","\n        ").concat(n.data?H.a.loaded:"","\n        ")})]})},J=n(21),F=n.n(J),G=function(){return Object(a.jsx)("div",{className:F.a.loading})},M=n(19),B=n(8),D=n.n(B),K=function(){var e=Object(r.useState)(""),t=Object(M.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(""),i=Object(M.a)(c,2),u=i[0],f=i[1],j=Object(s.b)();return Object(a.jsxs)("form",{className:"anime",onSubmit:function(e){var t;e.preventDefault(),j((t={username:n,password:u},function(){var e=Object(d.a)(l.a.mark((function e(n){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n(C(t));case 3:if(a=e.sent,void 0===(r=a.payload).token){e.next=8;break}return e.next=8,n(P(r.token));case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()))},children:[Object(a.jsx)("label",{className:D.a.label,htmlFor:"username",children:"Usu\xe1rio"}),Object(a.jsx)("input",{className:D.a.input,id:"username",type:"text",value:n,onChange:function(e){var t=e.target;return o(t.value)}}),Object(a.jsx)("label",{className:D.a.label,htmlFor:"password",children:"Senhas"}),Object(a.jsx)("input",{className:D.a.input,id:"password",type:"password",value:u,onChange:function(e){var t=e.target;return f(t.value)}}),Object(a.jsx)("button",{className:D.a.button,children:"Enviar"})]})},U=n(9),z=n.n(U),R=function(){var e=Object(s.c)((function(e){return e.photos})).list;return Object(a.jsx)("ul",{className:z.a.list,children:e.map((function(e){return Object(a.jsxs)("li",{className:"".concat(z.a.item," anime"),children:[Object(a.jsx)("img",{src:e.src,alt:e.title,className:z.a.imagem}),Object(a.jsx)("h2",{className:z.a.titulo,children:e.title}),Object(a.jsx)("span",{className:z.a.acessos,children:e.acessos})]},e.id)}))})},Y=n(22),V=n.n(Y),W=function(){var e=Object(s.c)((function(e){return e.photos})),t=e.pages,n=e.infinite,r=e.loading,o=Object(s.b)();return r?Object(a.jsx)(G,{}):n?Object(a.jsx)("button",{onClick:function(){o(k(t+1))},className:V.a.button,children:"+"}):null},X=function(){var e=Object(s.b)();return o.a.useEffect((function(){e(k(1))}),[e]),Object(a.jsxs)("section",{children:[Object(a.jsx)(R,{}),Object(a.jsx)(W,{})]})},Z=function(){var e=Object(s.c)((function(e){return e.login})),t=e.user,n=e.token;return t.loading||n.loading?Object(a.jsx)(G,{}):t.data?Object(a.jsx)(X,{}):Object(a.jsx)(K,{})};n(35);var q=function(){var e=Object(s.b)();return o.a.useEffect((function(){e(function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n(),!(r=a.login.token.data.token)){e.next=5;break}return e.next=5,t(P(r));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}),[e]),Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)(I,{}),Object(a.jsx)(Z,{})]})},Q=function(e){return function(e){return function(t){var n=e(t),a=t.meta;if(a&&a.localStorage){var r=a.localStorage,o=r.key,c=r.value;window.localStorage.setItem(o,JSON.stringify(c))}return n}}},$=[].concat(Object(m.a)(Object(p.c)()),[Q]),ee=Object(f.c)({login:T,photos:y}),te=Object(p.a)({reducer:ee,middleware:$});i.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(s.a,{store:te,children:Object(a.jsx)(q,{})})}),document.getElementById("root"))},7:function(e,t,n){e.exports={header:"Header_header__2eWda",title:"Header_title__dYh9M",login:"Header_login__2R5pX",loading:"Header_loading__FPuvE",loaded:"Header_loaded__AZ-eF"}},8:function(e,t,n){e.exports={label:"Login_label__2gGES",input:"Login_input__2P7rD",button:"Login_button__2KxEA"}},9:function(e,t,n){e.exports={list:"PhotosContent_list__3yOYK",item:"PhotosContent_item__3T2kb",imagem:"PhotosContent_imagem__3w-8y",titulo:"PhotosContent_titulo__3KzBV",acessos:"PhotosContent_acessos__b6e0d"}}},[[36,1,2]]]);
//# sourceMappingURL=main.4dcf042b.chunk.js.map